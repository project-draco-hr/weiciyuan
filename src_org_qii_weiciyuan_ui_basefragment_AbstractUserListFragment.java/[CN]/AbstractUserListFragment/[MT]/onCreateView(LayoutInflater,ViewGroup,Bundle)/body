{
  View view=inflater.inflate(R.layout.fragment_listview_layout,container,false);
  empty=(TextView)view.findViewById(R.id.empty);
  progressBar=(ProgressBar)view.findViewById(R.id.progressbar);
  pullToRefreshListView=(PullToRefreshListView)view.findViewById(R.id.listView);
  pullToRefreshListView.setOnRefreshListener(new PullToRefreshBase.OnRefreshListener<ListView>(){
    @Override public void onRefresh(    PullToRefreshBase<ListView> refreshView){
      refresh();
    }
  }
);
  pullToRefreshListView.setOnLastItemVisibleListener(new PullToRefreshBase.OnLastItemVisibleListener(){
    @Override public void onLastItemVisible(){
      listViewFooterViewClick(null);
    }
  }
);
  footerView=inflater.inflate(R.layout.fragment_listview_footer_layout,null);
  getListView().addFooterView(footerView);
  dismissFooterView();
  timeLineAdapter=new UserListAdapter(AbstractUserListFragment.this,((AbstractAppActivity)getActivity()).getCommander(),bean.getUsers(),getListView());
  pullToRefreshListView.setAdapter(timeLineAdapter);
  pullToRefreshListView.setOnScrollListener(new AbsListView.OnScrollListener(){
    @Override public void onScrollStateChanged(    AbsListView view,    int scrollState){
switch (scrollState) {
case AbsListView.OnScrollListener.SCROLL_STATE_IDLE:
        if (!enableRefreshTime) {
          enableRefreshTime=true;
          getAdapter().notifyDataSetChanged();
        }
      break;
case AbsListView.OnScrollListener.SCROLL_STATE_FLING:
    enableRefreshTime=false;
  break;
case AbsListView.OnScrollListener.SCROLL_STATE_TOUCH_SCROLL:
enableRefreshTime=true;
break;
}
}
@Override public void onScroll(AbsListView view,int firstVisibleItem,int visibleItemCount,int totalItemCount){
}
}
);
getListView().setOnItemClickListener(new AdapterView.OnItemClickListener(){
@Override public void onItemClick(AdapterView<?> parent,View view,int position,long id){
if (mActionMode != null) {
getListView().clearChoices();
mActionMode.finish();
mActionMode=null;
return;
}
getListView().clearChoices();
if (position - 1 < getList().getUsers().size()) {
listViewItemClick(parent,view,position - 1,id);
}
 else {
listViewFooterViewClick(view);
}
}
}
);
return view;
}
