{
  if (msg.getUser() != null) {
    if (TextUtils.isEmpty(msg.getUser().getRemark()))     layout.username.setText(msg.getUser().getScreen_name());
 else     layout.username.setText(msg.getUser().getScreen_name() + "(" + msg.getUser().getRemark()+ ")");
    TimeLineBitmapDownloader.getInstance().downloadAvatar(layout.avatar,msg.getUser());
  }
  layout.content.setText(msg.getListViewSpannableString());
  layout.content.setMovementMethod(LongClickableLinkMovementMethod.getInstance());
  layout.time.setText(msg.getTimeInFormat());
  if (msg.getGeo() != null) {
    layout.mapView.setVisibility(View.VISIBLE);
    if (Utility.isTaskStopped(geoTask)) {
      geoTask=new GetWeiboLocationInfoTask(getActivity(),msg.getGeo(),layout.mapView,layout.location);
      geoTask.executeOnExecutor(MyAsyncTask.THREAD_POOL_EXECUTOR);
    }
  }
 else {
    layout.mapView.setVisibility(View.GONE);
  }
  if (!TextUtils.isEmpty(msg.getSource())) {
    layout.source.setText(Html.fromHtml(msg.getSource()).toString());
  }
  layout.content_pic.setVisibility(View.GONE);
  layout.content_pic_multi.setVisibility(View.GONE);
  if (!TextUtils.isEmpty(msg.getBmiddle_pic()) && msg.getRetweeted_status() == null) {
    if (!msg.isMultiPics()) {
      if (Utility.isTaskStopped(picTask)) {
        layout.content_pic.setVisibility(View.VISIBLE);
        if (refreshPic) {
          picTask=new MsgDetailReadWorker(layout.content_pic,msg);
          picTask.executeOnExecutor(MyAsyncTask.THREAD_POOL_EXECUTOR);
        }
      }
    }
 else {
      layout.content_pic_multi.setVisibility(View.VISIBLE);
      int count=msg.getPicCount();
      for (int i=0; i < count; i++) {
        ImageView pic=(ImageView)layout.content_pic_multi.getChildAt(i);
        pic.setVisibility(View.VISIBLE);
        TimeLineBitmapDownloader.getInstance().displayMultiPicture(pic,msg.getMiddlePicUrls().get(i),FileLocationMethod.picture_bmiddle);
        final int finalI=i;
        pic.setOnClickListener(new View.OnClickListener(){
          @Override public void onClick(          View v){
            Intent intent=new Intent(getActivity(),GalleryActivity.class);
            intent.putExtra("msg",msg);
            intent.putExtra("position",finalI);
            getActivity().startActivity(intent);
          }
        }
);
      }
      if (count < 9) {
        for (int i=count; i < 9; i++) {
          ImageView pic=(ImageView)layout.content_pic_multi.getChildAt(i);
          pic.setVisibility(View.GONE);
        }
      }
    }
  }
  final MessageBean repostMsg=msg.getRetweeted_status();
  layout.repost_layout.setVisibility(repostMsg != null ? View.VISIBLE : View.GONE);
  if (repostMsg != null) {
    layout.content_pic.setVisibility(View.GONE);
    layout.repost_layout.setVisibility(View.VISIBLE);
    layout.recontent.setVisibility(View.VISIBLE);
    layout.recontent.setMovementMethod(LongClickableLinkMovementMethod.getInstance());
    if (repostMsg.getUser() != null) {
      layout.recontent.setText(repostMsg.getListViewSpannableString());
      buildRepostCount();
    }
 else {
      layout.recontent.setText(repostMsg.getListViewSpannableString());
    }
    layout.repost_pic.setVisibility(View.GONE);
    layout.repost_pic_multi.setVisibility(View.GONE);
    if (!TextUtils.isEmpty(repostMsg.getBmiddle_pic())) {
      if (!repostMsg.isMultiPics()) {
        if (Utility.isTaskStopped(picTask)) {
          layout.repost_pic.setVisibility(View.VISIBLE);
          if (refreshPic) {
            picTask=new MsgDetailReadWorker(layout.repost_pic,repostMsg);
            picTask.executeOnExecutor(MyAsyncTask.THREAD_POOL_EXECUTOR);
          }
        }
      }
 else {
        layout.repost_pic_multi.setVisibility(View.VISIBLE);
        int count=repostMsg.getPicCount();
        for (int i=0; i < count; i++) {
          ImageView pic=(ImageView)layout.repost_pic_multi.getChildAt(i);
          pic.setVisibility(View.VISIBLE);
          TimeLineBitmapDownloader.getInstance().displayMultiPicture(pic,repostMsg.getMiddlePicUrls().get(i),FileLocationMethod.picture_bmiddle);
          final int finalI=i;
          pic.setOnClickListener(new View.OnClickListener(){
            @Override public void onClick(            View v){
              Intent intent=new Intent(getActivity(),GalleryActivity.class);
              intent.putExtra("msg",repostMsg);
              intent.putExtra("position",finalI);
              getActivity().startActivity(intent);
            }
          }
);
        }
        if (count < 9) {
          for (int i=count; i < 9; i++) {
            ImageView pic=(ImageView)layout.repost_pic_multi.getChildAt(i);
            pic.setVisibility(View.GONE);
          }
        }
      }
    }
 else {
      layout.repost_pic.setVisibility(View.GONE);
    }
  }
  Utility.buildTabCount(commentTab,getString(R.string.comments),msg.getComments_count());
  Utility.buildTabCount(repostTab,getString(R.string.repost),msg.getReposts_count());
}
