{
  final long timestamp=System.currentTimeMillis() / 1000;
  final long nonce=timestamp + (new Random()).nextInt();
  WeiboParameters authParams=this.generateAuthParameters(nonce,timestamp,token);
  WeiboParameters signatureParams=this.generateSignatureParameters(authParams,params,url);
  String oauthBaseString=this.generateAuthSignature(method,signatureParams,url,token);
  String signature=generateSignature(oauthBaseString,token);
  authParams.add("oauth_signature",signature);
  this.addAdditionalParams(authParams,params);
  return "OAuth " + encodeParameters(authParams,",",true);
}
