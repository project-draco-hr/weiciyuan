{
  this.topTipBar=bar;
  AutoScrollListView autoScrollListView=(AutoScrollListView)listView;
  onScrollListener=((AutoScrollListView)listView).getOnScrollListener();
  autoScrollListView.setOnScrollListener(new AbsListView.OnScrollListener(){
    int lastVisibleItem=-1;
    @Override public void onScrollStateChanged(    AbsListView view,    int scrollState){
      onScrollListener.onScrollStateChanged(view,scrollState);
    }
    @Override public void onScroll(    AbsListView view,    int firstVisibleItem,    int visibleItemCount,    int totalItemCount){
      onScrollListener.onScroll(view,firstVisibleItem,visibleItemCount,totalItemCount);
      if (topTipBar.getValues().size() == 0) {
        return;
      }
      View childView=Utility.getListViewItemViewFromPosition(listView,firstVisibleItem);
      if (childView != null) {
        if (firstVisibleItem < lastVisibleItem)         handle(firstVisibleItem + 1);
        if (childView.getTop() == 0) {
          handle(firstVisibleItem);
          lastVisibleItem=firstVisibleItem;
          if (firstVisibleItem == 0) {
            topTipBar.clearAndReset();
          }
        }
      }
    }
    private void handle(    int position){
      if (topTipBar != null && position < bean.size()) {
        MessageBean next=bean.get(position);
        if (next != null) {
          topTipBar.handle(next.getId());
        }
      }
    }
  }
);
}
