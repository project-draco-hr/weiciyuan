{
  super.onActivityCreated(savedInstanceState);
  commander=((AbstractAppActivity)getActivity()).getBitmapDownloader();
switch (getCurrentState(savedInstanceState)) {
case FIRST_TIME_START:
    if (Utility.isTaskStopped(dbTask)) {
      dbTask=new DBCacheTask();
      dbTask.executeOnExecutor(MyAsyncTask.THREAD_POOL_EXECUTOR);
    }
  groupDataCache.put(TYPE_RECEIVED_COMMENT,new CommentListBean());
groupDataCache.put(TYPE_MENTIONED_COMMENT_TO_ME,new CommentListBean());
groupDataCache.put(TYPE_COMMENT_BY_ME,new CommentListBean());
break;
case SCREEN_ROTATE:
refreshLayout(bean);
break;
case ACTIVITY_DESTROY_AND_CREATE:
userBean=(UserBean)savedInstanceState.getSerializable("userBean");
accountBean=(AccountBean)savedInstanceState.getSerializable("account");
token=savedInstanceState.getString("token");
groupNames=savedInstanceState.getStringArray("groupNames");
currentGroupId=savedInstanceState.getInt("currentGroupId");
unreadBean=(UnreadBean)savedInstanceState.getSerializable("unreadBean");
groupDataCache.put(TYPE_RECEIVED_COMMENT,(CommentListBean)savedInstanceState.getSerializable("0"));
groupDataCache.put(TYPE_MENTIONED_COMMENT_TO_ME,(CommentListBean)savedInstanceState.getSerializable("1"));
groupDataCache.put(TYPE_COMMENT_BY_ME,(CommentListBean)savedInstanceState.getSerializable("2"));
clearAndReplaceValue((CommentListBean)savedInstanceState.getSerializable("bean"));
timeLineAdapter.notifyDataSetChanged();
refreshLayout(getList());
break;
}
refreshUnread(unreadBean);
getListView().setChoiceMode(AbsListView.CHOICE_MODE_SINGLE);
getListView().setOnItemLongClickListener(new AdapterView.OnItemLongClickListener(){
@Override public boolean onItemLongClick(AdapterView<?> parent,View view,int position,long id){
if (position - 1 < getList().getSize() && position - 1 >= 0) {
if (mActionMode != null) {
mActionMode.finish();
mActionMode=null;
getListView().setItemChecked(position,true);
timeLineAdapter.notifyDataSetChanged();
mActionMode=getActivity().startActionMode(new CommentSingleChoiceModeListener(getListView(),timeLineAdapter,CommentsTimeLineFragment.this,getList().getItemList().get(position - 1)));
return true;
}
 else {
getListView().setItemChecked(position,true);
timeLineAdapter.notifyDataSetChanged();
mActionMode=getActivity().startActionMode(new CommentSingleChoiceModeListener(getListView(),timeLineAdapter,CommentsTimeLineFragment.this,getList().getItemList().get(position - 1)));
return true;
}
}
return false;
}
}
);
}
