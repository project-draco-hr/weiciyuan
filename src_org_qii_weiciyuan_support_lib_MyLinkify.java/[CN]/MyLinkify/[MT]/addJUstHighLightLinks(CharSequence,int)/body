{
  if (mask == 0) {
    return SpannableString.valueOf(text);
  }
  CharSequence t=text;
  if (t instanceof Spannable) {
    if (addLinks((Spannable)t,mask)) {
      return SpannableString.valueOf(t);
    }
  }
 else {
    SpannableString s=SpannableString.valueOf(t);
    if (addLinks(s,mask)) {
      return s;
    }
  }
  return SpannableString.valueOf(text);
}
